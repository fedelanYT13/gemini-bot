const _0x31e681=_0x31a8;(function(_0x4700f5,_0x459cd5){const _0x23b674=_0x31a8,_0x488c4f=_0x4700f5();while(!![]){try{const _0x5555f1=parseInt(_0x23b674(0x167))/0x1*(parseInt(_0x23b674(0x15c))/0x2)+-parseInt(_0x23b674(0x179))/0x3+parseInt(_0x23b674(0x16c))/0x4*(parseInt(_0x23b674(0x1a7))/0x5)+parseInt(_0x23b674(0x16e))/0x6+-parseInt(_0x23b674(0x18b))/0x7+parseInt(_0x23b674(0x18d))/0x8*(-parseInt(_0x23b674(0x188))/0x9)+parseInt(_0x23b674(0x197))/0xa;if(_0x5555f1===_0x459cd5)break;else _0x488c4f['push'](_0x488c4f['shift']());}catch(_0xb91741){_0x488c4f['push'](_0x488c4f['shift']());}}}(_0x4efa,0x826cf));import _0x1756dd from'node-fetch';function _0x4efa(){const _0x341b35=['parse','test','4717915xRWrEP','lastRolledId','delirius','chat','name','now','image','variants','floor','ver','rollwaifu','replace','git+https://github.com/The-King-Destroy/YukiBot-MD.git','some','lastRoll','string','isGroup','value','❀\x20El\x20comando\x20*<','media_asset','/search/gelbooru?query=','application/json','*\x0a⚥\x20Género\x20»\x20*','*\x0a✰\x20Valor\x20»\x20*','headers','\x20minuto','247502SEzBpB','chats','lastRolledMsgId','trim','*\x0a♡\x20Estado\x20»\x20*','then','./package.json','reservedUntil','content-type','utf-8','sendFile','1LhTnPD','ceil','split','Sin\x20nombre','number','4hPYfmb','user','8190JckPnK','toLowerCase','url','APIs','entries','readFile','writeFile','random','json','catch','tags','1518195vRKOKA','votes','>*\x20solo\x20está\x20disponible\x20para\x20Yuki\x20Suou.\x0a>\x20https://github.com/The-King-Destroy/YukiBot-MD','find','includes','getName','./lib/characters.json','access','report\x20para\x20informarlo.\x0a\x0a','*\x20de\x20nuevo.','data','group','help','https://danbooru.donmai.us/posts.json?tags=','map','2588553KfRspP','⚠︎\x20Se\x20ha\x20producido\x20un\x20problema.\x0a>\x20Usa\x20','repository','6161449wEAdhQ','characters','24WYXGFe','\x20segundo','users','values','gender','ꕥ\x20Los\x20comandos\x20de\x20*Gacha*\x20están\x20desactivados\x20en\x20este\x20grupo.\x0a\x0aUn\x20*administrador*\x20puede\x20activarlos\x20con\x20el\x20comando:\x0a»\x20*','large_file_url','length','reply','.jpg','17146470oWtYhH','ꕥ\x20Debes\x20esperar\x20*','Libre','sender','post','roll','key','expiresAt','Reclamado\x20por\x20','Mozilla/5.0','message','*\x0a❖\x20Fuente\x20»\x20*','command','file_url'];_0x4efa=function(){return _0x341b35;};return _0x4efa();}function _0x31a8(_0xb165c3,_0x360ed6){const _0x4efa2a=_0x4efa();return _0x31a8=function(_0x31a817,_0x29c3e9){_0x31a817=_0x31a817-0x14a;let _0x240f8f=_0x4efa2a[_0x31a817];return _0x240f8f;},_0x31a8(_0xb165c3,_0x360ed6);}import{promises as _0xd02b6a}from'fs';const FILE_PATH=_0x31e681(0x17f);async function loadCharacters(){const _0x38b6a2=_0x31e681;try{await _0xd02b6a[_0x38b6a2(0x180)](FILE_PATH);}catch{await _0xd02b6a[_0x38b6a2(0x174)](FILE_PATH,'{}');}const _0xc71a3e=await _0xd02b6a['readFile'](FILE_PATH,'utf-8');return JSON[_0x38b6a2(0x1a5)](_0xc71a3e);}function flattenCharacters(_0x111976){const _0x292d5f=_0x31e681;return Object[_0x292d5f(0x190)](_0x111976)['flatMap'](_0x1c4553=>Array['isArray'](_0x1c4553['characters'])?_0x1c4553['characters']:[]);}function getSeriesNameByCharacter(_0x4f8e7d,_0x23f241){const _0x4ea451=_0x31e681;return Object[_0x4ea451(0x172)](_0x4f8e7d)[_0x4ea451(0x17c)](([,_0x49760b])=>Array['isArray'](_0x49760b['characters'])&&_0x49760b[_0x4ea451(0x18c)][_0x4ea451(0x14f)](_0x42118b=>String(_0x42118b['id'])===String(_0x23f241)))?.[0x1]?.[_0x4ea451(0x1ab)]||'Desconocido';}function formatTag(_0x2d21e6){const _0x371463=_0x31e681;return String(_0x2d21e6)[_0x371463(0x15f)]()[_0x371463(0x16f)]()[_0x371463(0x14d)](/\s+/g,'_');}async function buscarImagenDelirius(_0x15c321){const _0x3b13d8=_0x31e681,_0x2a4325=formatTag(_0x15c321),_0x141c97=['https://safebooru.org/index.php?page=dapi&s=post&q=index&json=1&tags='+_0x2a4325,_0x3b13d8(0x186)+_0x2a4325,global[_0x3b13d8(0x171)][_0x3b13d8(0x1a9)][_0x3b13d8(0x170)]+_0x3b13d8(0x156)+_0x2a4325];for(const _0x50fc69 of _0x141c97){try{const _0x437bb5=await _0x1756dd(_0x50fc69,{'headers':{'User-Agent':_0x3b13d8(0x1a0),'Accept':_0x3b13d8(0x157)}}),_0x5da82b=_0x437bb5[_0x3b13d8(0x15a)]['get'](_0x3b13d8(0x164))||'';if(!_0x437bb5['ok']||!_0x5da82b[_0x3b13d8(0x17d)](_0x3b13d8(0x176)))continue;const _0x2170b9=await _0x437bb5[_0x3b13d8(0x176)](),_0x94dd79=Array['isArray'](_0x2170b9)?_0x2170b9:_0x2170b9?.[_0x3b13d8(0x19b)]||_0x2170b9?.[_0x3b13d8(0x183)]||[],_0x2623a8=_0x94dd79[_0x3b13d8(0x187)](_0x43dfa7=>_0x43dfa7?.[_0x3b13d8(0x1a4)]||_0x43dfa7?.[_0x3b13d8(0x193)]||_0x43dfa7?.[_0x3b13d8(0x1ad)]||_0x43dfa7?.[_0x3b13d8(0x155)]?.[_0x3b13d8(0x1ae)]?.[0x0]?.[_0x3b13d8(0x170)])['filter'](_0x2c4ece=>typeof _0x2c4ece===_0x3b13d8(0x151)&&/\.(jpe?g|png)$/[_0x3b13d8(0x1a6)](_0x2c4ece));if(_0x2623a8['length'])return _0x2623a8;}catch{}}return[];}const verifi=async()=>{const _0x229155=_0x31e681;try{const _0x2f140c=await _0xd02b6a[_0x229155(0x173)](_0x229155(0x162),_0x229155(0x165)),_0x4ba22e=JSON[_0x229155(0x1a5)](_0x2f140c);return _0x4ba22e[_0x229155(0x18a)]?.['url']===_0x229155(0x14e);}catch{return![];}},handler=async(_0x52e8ea,{conn:_0x52624e,usedPrefix:_0x28c296,command:_0x37efe9})=>{const _0x188cfe=_0x31e681;if(!await verifi())return _0x52624e['reply'](_0x52e8ea[_0x188cfe(0x1aa)],_0x188cfe(0x154)+_0x37efe9+_0x188cfe(0x17b),_0x52e8ea);const _0x24a0ee=global['db'][_0x188cfe(0x183)][_0x188cfe(0x15d)];if(!_0x24a0ee[_0x52e8ea['chat']])_0x24a0ee[_0x52e8ea[_0x188cfe(0x1aa)]]={};const _0x1455b9=_0x24a0ee[_0x52e8ea['chat']];if(!_0x1455b9[_0x188cfe(0x18c)])_0x1455b9[_0x188cfe(0x18c)]={};if(!_0x1455b9['gacha']&&_0x52e8ea[_0x188cfe(0x152)])return _0x52e8ea[_0x188cfe(0x195)](_0x188cfe(0x192)+_0x28c296+'gacha\x20on*');const _0x258d6a=global['db'][_0x188cfe(0x183)][_0x188cfe(0x18f)][_0x52e8ea[_0x188cfe(0x19a)]],_0x5f5a92=Date[_0x188cfe(0x1ac)](),_0x377610=0xf*0x3c*0x3e8;if(_0x258d6a[_0x188cfe(0x150)]&&_0x5f5a92<_0x258d6a[_0x188cfe(0x150)]){const _0x5e244b=Math[_0x188cfe(0x168)]((_0x258d6a[_0x188cfe(0x150)]-_0x5f5a92)/0x3e8),_0xa625cb=Math['floor'](_0x5e244b/0x3c),_0x2bcabe=_0x5e244b%0x3c;let _0x250486='';if(_0xa625cb>0x0)_0x250486+=_0xa625cb+_0x188cfe(0x15b)+(_0xa625cb!==0x1?'s':'')+'\x20';if(_0x2bcabe>0x0||_0x250486==='')_0x250486+=_0x2bcabe+_0x188cfe(0x18e)+(_0x2bcabe!==0x1?'s':'');return _0x52e8ea[_0x188cfe(0x195)](_0x188cfe(0x198)+_0x250486[_0x188cfe(0x15f)]()+'*\x20para\x20usar\x20*'+(_0x28c296+_0x37efe9)+_0x188cfe(0x182));}try{const _0x575937=await loadCharacters(),_0x87f143=flattenCharacters(_0x575937),_0x1bbcdf=_0x87f143[Math[_0x188cfe(0x14a)](Math['random']()*_0x87f143[_0x188cfe(0x194)])],_0x58e804=String(_0x1bbcdf['id']),_0x17c098=getSeriesNameByCharacter(_0x575937,_0x1bbcdf['id']),_0x1100a8=formatTag(_0x1bbcdf[_0x188cfe(0x178)]?.[0x0]||''),_0x10818e=await buscarImagenDelirius(_0x1100a8),_0x53c4e2=_0x10818e[Math[_0x188cfe(0x14a)](Math[_0x188cfe(0x175)]()*_0x10818e[_0x188cfe(0x194)])];if(!_0x53c4e2)return _0x52e8ea[_0x188cfe(0x195)]('ꕥ\x20No\x20se\x20encontró\x20imágenes\x20para\x20el\x20personaje\x20*'+_0x1bbcdf[_0x188cfe(0x1ab)]+'*.');if(!global['db'][_0x188cfe(0x183)][_0x188cfe(0x18c)])global['db'][_0x188cfe(0x183)][_0x188cfe(0x18c)]={};if(!global['db'][_0x188cfe(0x183)][_0x188cfe(0x18c)][_0x58e804])global['db']['data'][_0x188cfe(0x18c)][_0x58e804]={};const _0x52604a=global['db'][_0x188cfe(0x183)][_0x188cfe(0x18c)][_0x58e804],_0x92c74a=global['db']['data'][_0x188cfe(0x18c)]?.[_0x58e804]||{};_0x52604a[_0x188cfe(0x1ab)]=String(_0x1bbcdf[_0x188cfe(0x1ab)]||_0x188cfe(0x16a)),_0x52604a[_0x188cfe(0x153)]=typeof _0x92c74a[_0x188cfe(0x153)]===_0x188cfe(0x16b)?_0x92c74a[_0x188cfe(0x153)]:Number(_0x1bbcdf[_0x188cfe(0x153)])||0x64,_0x52604a[_0x188cfe(0x17a)]=Number(_0x52604a[_0x188cfe(0x17a)]||_0x92c74a[_0x188cfe(0x17a)]||0x0),_0x52604a['reservedBy']=_0x52e8ea[_0x188cfe(0x19a)],_0x52604a[_0x188cfe(0x163)]=_0x5f5a92+0x4e20,_0x52604a[_0x188cfe(0x19e)]=_0x5f5a92+0xea60;let _0x3491a7=await((async()=>typeof _0x52604a[_0x188cfe(0x16d)]===_0x188cfe(0x151)&&_0x52604a[_0x188cfe(0x16d)][_0x188cfe(0x15f)]()?global['db'][_0x188cfe(0x183)][_0x188cfe(0x18f)][_0x52604a['user']]?.[_0x188cfe(0x1ab)]?.[_0x188cfe(0x15f)]()||await _0x52624e[_0x188cfe(0x17e)](_0x52604a[_0x188cfe(0x16d)])[_0x188cfe(0x161)](_0x52bee7=>typeof _0x52bee7==='string'&&_0x52bee7[_0x188cfe(0x15f)]()?_0x52bee7:_0x52604a['user']['split']('@')[0x0])[_0x188cfe(0x177)](()=>_0x52604a[_0x188cfe(0x16d)][_0x188cfe(0x169)]('@')[0x0]):'desconocido')());const _0x4281e8='❀\x20Nombre\x20»\x20*'+_0x52604a[_0x188cfe(0x1ab)]+_0x188cfe(0x158)+(_0x1bbcdf[_0x188cfe(0x191)]||'Desconocido')+_0x188cfe(0x159)+_0x52604a[_0x188cfe(0x153)]['toLocaleString']()+_0x188cfe(0x160)+(_0x52604a[_0x188cfe(0x16d)]?_0x188cfe(0x19f)+_0x3491a7:_0x188cfe(0x199))+_0x188cfe(0x1a2)+_0x17c098+'*',_0x310243=await _0x52624e[_0x188cfe(0x166)](_0x52e8ea[_0x188cfe(0x1aa)],_0x53c4e2,_0x52604a[_0x188cfe(0x1ab)]+_0x188cfe(0x196),_0x4281e8,_0x52e8ea);_0x1455b9[_0x188cfe(0x1a8)]=_0x58e804,_0x1455b9[_0x188cfe(0x15e)]=_0x310243[_0x188cfe(0x19d)]?.['id']||null,_0x1455b9['lastRolledCharacter']={'id':_0x58e804,'name':_0x52604a['name'],'media':_0x53c4e2},_0x258d6a[_0x188cfe(0x150)]=_0x5f5a92+_0x377610;}catch(_0x3a0e46){await _0x52624e[_0x188cfe(0x195)](_0x52e8ea[_0x188cfe(0x1aa)],_0x188cfe(0x189)+_0x28c296+_0x188cfe(0x181)+_0x3a0e46[_0x188cfe(0x1a1)],_0x52e8ea);}};handler[_0x31e681(0x185)]=[_0x31e681(0x14b),'rw',_0x31e681(0x14c)],handler[_0x31e681(0x178)]=['gacha'],handler[_0x31e681(0x1a3)]=[_0x31e681(0x14c),'rw',_0x31e681(0x19c)],handler[_0x31e681(0x184)]=!![];export default handler;